import cv2
import numpy as np

# рзз. ржнрзЛржЯ ржжрзЗржУрзЯрж╛ ржмрзНржпрж╛рж▓ржЯ ржкрзЗржкрж╛рж░ржЯрж┐ рж▓рзЛржб ржХрж░рж╛
image = cv2.imread('voted_ballot.jpg')
gray = cv2.cvtColor(image, cv2.COLOR_BGR2GRAY)

# рзи. ржкрзНрж░рж╛рж░рзНржерзАржжрзЗрж░ ржЧрзЛрж▓рзНрж▓рж╛рж░ ржЕржмрж╕рзНржерж╛ржи (Coordinates) рж╕рзЗржЯ ржХрж░рж╛
# ржЖржорж░рж╛ ржЖржЧрзЗрж░ ржХрзЛржб ржерзЗржХрзЗ ржЬрж╛ржирж┐ ржЧрзЛрж▓рзНрж▓рж╛ржЧрзБрж▓рзЛ ржХрзЛржерж╛рзЯ ржЖржЫрзЗ:
# Candidate A: (500, 240)
# Candidate B: (500, 390)
# Candidate C: (500, 540)

candidates = {
    "Candidate A (Boat)": (500, 240),
    "Candidate B (Paddy)": (500, 390),
    "Candidate C (Plough)": (500, 540)
}

print("Starting Vote Count...\n")

winner = None
max_votes = 0

# рзй. рж▓рзБржк ржЪрж╛рж▓рж┐рзЯрзЗ ржкрзНрж░рждрж┐ржЯрж┐ ржХрзНржпрж╛ржирзНржбрж┐ржбрзЗржЯрзЗрж░ ржЧрзЛрж▓рзНрж▓рж╛ ржЪрзЗржХ ржХрж░рж╛
for name, (x, y) in candidates.items():
    # ржЧрзЛрж▓рзНрж▓рж╛рж░ ржЪрж╛рж░ржкрж╛рж╢рзЗ ржПржХржЯрж┐ ржЫрзЛржЯ ржЪрж╛рж░ржХрзЛржирж╛ ржмржХрзНрж╕ (ROI - Region of Interest) ржХрзЗржЯрзЗ ржирзЗржУрзЯрж╛
    # ржЖржорж░рж╛ рзлрзжxрзлрзж ржкрж┐ржХрзНрж╕рзЗрж▓рзЗрж░ ржПржХржЯрж╛ ржмржХрзНрж╕ ржХрж╛ржЯржм ржЧрзЛрж▓рзНрж▓рж╛ржХрзЗ ржХрзЗржирзНржжрзНрж░ ржХрж░рзЗ
    roi = gray[y - 25:y + 25, x - 25:x + 25]

    # ржХрж╛рж▓рзЛ ржкрж┐ржХрзНрж╕рзЗрж▓ ржЧржгржирж╛ ржХрж░рж╛ (рзж ржорж╛ржирзЗ ржХрж╛рж▓рзЛ, рзирзлрзл ржорж╛ржирзЗ рж╕рж╛ржжрж╛)
    # np.sum(roi < 100) ржорж╛ржирзЗ ржпрзЗ ржкрж┐ржХрзНрж╕рзЗрж▓ржЧрзБрж▓рзЛ ржЧрж╛рзЭ (ржХрж╛рж▓рзЛ ржХрж╛рж▓рж┐рж░ ржжрж╛ржЧ) рж╕рзЗржЧрзБрж▓рзЛ ржЧрзБржиржмрзЗ
    black_pixel_count = np.sum(roi < 100)

    print(f"Checking {name}: Found {black_pixel_count} black pixels.")

    # рзк. рж▓ржЬрж┐ржХ: ржпржжрж┐ ржХрж╛рж▓рзЛ ржкрж┐ржХрзНрж╕рзЗрж▓ рзлрзжрзж ржПрж░ ржмрзЗрж╢рж┐ рж╣рзЯ, рждрж╛рж░ ржорж╛ржирзЗ ржПржЦрж╛ржирзЗ рж╕рж┐рж▓ ржорж╛рж░рж╛ рж╣рзЯрзЗржЫрзЗ
    if black_pixel_count > 500:
        print(f"тЬЕ VOTE DETECTED for {name}!")
        winner = name
    else:
        print(f"тЭМ No vote for {name}")

print("-" * 30)
if winner:
    print(f"ЁЯПЖ FINAL RESULT: The Winner is {winner}!")
else:
    print("тЪая╕П RESULT: No valid vote found (Blank Ballot).")